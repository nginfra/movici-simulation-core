{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "/water_network_simulation/1.0.0",
  "type": "object",
  "required": ["mode"],
  "properties": {
    "mode": {
      "type": "string",
      "enum": ["inp_file", "movici_network"],
      "default": "movici_network",
      "description": "Network loading mode: 'inp_file' loads from EPANET INP, 'movici_network' builds from Movici datasets"
    },
    "inp_file": {
      "type": "string",
      "description": "Path to EPANET INP file (required if mode='inp_file')"
    },
    "dataset": {
      "type": "string",
      "movici.type": "dataset",
      "description": "Water network dataset name (required if mode='movici_network')"
    },
    "entity_groups": {
      "type": "array",
      "items": {
        "type": "string",
        "enum": ["junctions", "tanks", "reservoirs", "pipes", "pumps", "valves"]
      },
      "default": ["junctions", "pipes", "reservoirs"],
      "description": "Entity groups to include from the dataset"
    },
    "simulation_duration": {
      "type": "number",
      "description": "Total simulation duration in seconds (if not specified, uses model default or Movici timeline)"
    },
    "hydraulic_timestep": {
      "type": "number",
      "default": 3600,
      "description": "Hydraulic timestep in seconds (default: 3600 = 1 hour)"
    },
    "report_timestep": {
      "type": "number",
      "description": "Report timestep in seconds (default: same as hydraulic_timestep)"
    },
    "viscosity": {
      "type": "number",
      "default": 1.0,
      "description": "Kinematic viscosity of water relative to standard (default: 1.0)"
    },
    "specific_gravity": {
      "type": "number",
      "default": 1.0,
      "description": "Specific gravity of water relative to standard (default: 1.0)"
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "mode": {
            "const": "inp_file"
          }
        }
      },
      "then": {
        "required": ["inp_file"]
      }
    },
    {
      "if": {
        "properties": {
          "mode": {
            "const": "movici_network"
          }
        }
      },
      "then": {
        "required": ["dataset"]
      }
    }
  ],
  "additionalProperties": false
}
